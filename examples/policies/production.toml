# Production Policy - Strict requirements for deployment
#
# Use: wsc verify-chain -i app.wasm --policy production.toml

[policy]
name = "production"
version = "1.0"
enforcement = "strict"

[slsa]
minimum_level = 2  # Require signed provenance
enforcement = "strict"

[signatures]
require_root_signatures = true
require_attestation_signatures = true
max_attestation_age_days = 30
enforcement = "strict"

# Trusted transformation tools
[trusted_tools.loom]
min_version = "0.1.0"
# Add public keys when Loom signs attestations:
# public_keys = [
#   { algorithm = "ed25519", key = "BASE64_PUBLIC_KEY", key_id = "loom-prod" }
# ]

[trusted_tools.wac]
min_version = "0.5.0"

# For keyless signing (GitHub Actions CI):
# [trusted_tools.loom.keyless]
# oidc_issuers = ["https://token.actions.githubusercontent.com"]
# subjects = ["https://github.com/aspect-build/loom/*"]
