// Test to verify the specific failing Rekor entry
// This will help us debug the Merkle tree verification

use wsc::keyless::RekorEntry;

fn main() {
    // Real production entry that's failing in tests (log index 702001471)
    let entry = RekorEntry {
        uuid: "108e9186e8c5677a0f907d46857881860e5e9a6e2612af592d27bb9e23a0b9c1c55db78582c8cc3c".to_string(),
        log_index: 702001471,
        body: "eyJhcGlWZXJzaW9uIjoiMC4wLjEiLCJraW5kIjoiaGFzaGVkcmVrb3JkIiwic3BlYyI6eyJkYXRhIjp7Imhhc2giOnsiYWxnb3JpdGhtIjoic2hhMjU2IiwidmFsdWUiOiI5M2E0NGJiYjk2Yzc1MTIxOGU0YzAwZDQ3OWU0YzE0MzU4MTIyYTM4OWFjY2ExNjIwNWIxZTRkMGRjNWY5NDc2In19LCJzaWduYXR1cmUiOnsiY29udGVudCI6InNtMFZLVnZjU01MOGdlKzNpWjVtczNaYjZSaFBteEEzWDNkTVpCMGZnMkMzQWZXRGlybzFKN01EN0pNTXpzb2dySFc1NWlpV1FUcUFkZlI4WVEwVm9RPT0iLCJwdWJsaWNLZXkiOnsiY29udGVudCI6IkxTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVWR5ZWtORFFtcFhaMEYzU1VKQlowbFZTbVp1VkV0bk9FdHNRM1UwVVhaQ00xSkdORVJCYjBadGFESm5kME5uV1VsTGIxcEplbW93UlVGM1RYY0tUbnBGVmsxQ1RVZEJNVlZGUTJoTlRXTXliRzVqTTFKMlkyMVZkVnBIVmpKTlVqUjNTRUZaUkZaUlVVUkZlRlo2WVZka2VtUkhPWGxhVXpGd1ltNVNiQXBqYlRGc1drZHNhR1JIVlhkSWFHTk9UV3BWZUUxVVJURk5SR3N3VFdwRmQxZG9ZMDVOYWxWNFRWUkZNVTFFYXpGTmFrVjNWMnBCUVUxR2EzZEZkMWxJQ2t0dldrbDZhakJEUVZGWlNVdHZXa2w2YWpCRVFWRmpSRkZuUVVWSFpVeFRNR3R0TDFVclkyMWxRa1JSV0VZM1dFTlNXRmx3TUV3MFVDOWpjVWM1UjAwS01qVTFWM1l5THk5bGRGRjFWRGRKTUZOelNIcHZMelkwVTNWMWJHSkpWV2swVUZCRWJqSlJjWFJxTDJFek0wSnNOSEZQUTBKV1VYZG5aMVpSVFVFMFJ3cEJNVlZrUkhkRlFpOTNVVVZCZDBsSVowUkJWRUpuVGxaSVUxVkZSRVJCUzBKblozSkNaMFZHUWxGalJFRjZRV1JDWjA1V1NGRTBSVVpuVVZWd09YUndDa0UzU0ZoV1p6RjJTR0k1WkVJcldtRlFXa1k1VW5JNGQwaDNXVVJXVWpCcVFrSm5kMFp2UVZVek9WQndlakZaYTBWYVlqVnhUbXB3UzBaWGFYaHBORmtLV2tRNGQxaG5XVVJXVWpCU1FWRklMMEpHVVhkVmIxcFJZVWhTTUdOSVRUWk1lVGx1WVZoU2IyUlhTWFZaTWpsMFRETkNNV0pJVG14YVZ6VnVZVmMxYkFwTU0yUjZXWGs0ZFZveWJEQmhTRlpwVEROa2RtTnRkRzFpUnprelkzazVlV1JZVGpCTWJteDBZa1ZDZVZwWFducE1NMEl4WWtkM2RrMXFRWFppVjFaNUNsb3lWWGRQVVZsTFMzZFpRa0pCUjBSMmVrRkNRVkZSY21GSVVqQmpTRTAyVEhrNU1HSXlkR3hpYVRWb1dUTlNjR0l5TlhwTWJXUndaRWRvTVZsdVZub0tXbGhLYW1JeU5UQmFWelV3VEcxT2RtSlVRV0ZDWjI5eVFtZEZSVUZaVHk5TlFVVkRRa0Y0ZDJSWGVITllNMHBzWTFoV2JHTXpVWGRPWjFsTFMzZFpRZ3BDUVVkRWRucEJRa0YzVVc5YWJWRXdUbXBKTUZwSFJYaE5WRVYzVGtkR2FrNUVaM2xOUkU1cldYcFJlRTlIU1hoYVJFcHBXa1JCZDA1cVdUSk9WMUpyQ2xwcVFWRkNaMjl5UW1kRlJVRlpUeTlOUVVWRlFrRktSRk5VUVdSQ1oyOXlRbWRGUlVGWlR5OU5RVVZHUWtFNWQyUlhlSHBhVjFaMVdqSnNkVnBUT1RNS1l6Sk5kMGxCV1V0TGQxbENRa0ZIUkhaNlFVSkNaMUZUWTIxV2JXTjVPWGRrVjNoelRIcEpkMHd5TVd4amJXUnNUVVJ6UjBOcGMwZEJVVkZDWnpjNGR3cEJVV2RGVEZGM2NtRklVakJqU0UwMlRIazVNR0l5ZEd4aWFUVm9XVE5TY0dJeU5YcE1iV1J3WkVkb01WbHVWbnBhV0VwcVlqSTFNRnBYTlRCTWJVNTJDbUpVUW1kQ1oyOXlRbWRGUlVGWlR5OU5RVVZLUWtaSlRWVkhhREJrU0VKNlQyazRkbG95YkRCaFNGWnBURzFPZG1KVE9YZGtWM2g2V2xkV2RWb3liSFVLV2xNNU0yTXlUWFpNYldSd1pFZG9NVmxwT1ROaU0wcHlXbTE0ZG1RelRYWmpibFo2WkVNMU5XSlhlRUZqYlZadFkzazVkMlJYZUhOTWVrbDNUREl4YkFwamJXUnNUVVJuUjBOcGMwZEJVVkZDWnpjNGQwRlJiMFZMWjNkdldtMVJNRTVxU1RCYVIwVjRUVlJGZDA1SFJtcE9SR2Q1VFVST2ExbDZVWGhQUjBsNENscEVTbWxhUkVGM1RtcFpNazVYVW10YWFrRmtRbWR2Y2tKblJVVkJXVTh2VFVGRlRFSkJPRTFFVjJSd1pFZG9NVmxwTVc5aU0wNHdXbGRSZDAxbldVc0tTM2RaUWtKQlIwUjJla0ZDUkVGUmEwUkRTbTlrU0ZKM1kzcHZka3d5WkhCa1IyZ3hXV2sxYW1JeU1IWmpTRlp6WXpKV2JHSnRaSEJpYlZWMlpETk9hZ3BOUkdkSFEybHpSMEZSVVVKbk56aDNRVkV3UlV0bmQyOWFiVkV3VG1wSk1GcEhSWGhOVkVWM1RrZEdhazVFWjNsTlJFNXJXWHBSZUU5SFNYaGFSRXBwQ2xwRVFYZE9hbGt5VGxkU2ExcHFRV2xDWjI5eVFtZEZSVUZaVHk5TlFVVlBRa0pSVFVWdVNteGFiazEyWTBoV2MySkRPSGxOUXpsMFdsaEtibHBVUVdFS1FtZHZja0puUlVWQldVOHZUVUZGVUVKQmQwMURha1YzVDBSbmVVOVVUWGxPVkVsM1RHZFpTMHQzV1VKQ1FVZEVkbnBCUWtWQlVXZEVRalZ2WkVoU2R3cGplbTkyVERKa2NHUkhhREZaYVRWcVlqSXdkbU5JVm5Oak1sWnNZbTFrY0dKdFZYZEhVVmxMUzNkWlFrSkJSMFIyZWtGQ1JWRlJURVJCYTNsTlZFMTRDazFxVVhoUFJGVjNXVUZaUzB0M1dVSkNRVWRFZG5wQlFrVm5VbE5FUmtKdlpFaFNkMk42YjNaTU1tUndaRWRvTVZscE5XcGlNakIyWTBoV2MyTXlWbXdLWW0xa2NHSnRWWFprTTA1cVRIazFibUZZVW05a1YwbDJaREk1ZVdFeVduTmlNMlI2VEROS01XTXpVWFZsVnpGelVVaEtiRnB1VFhaalNGWnpZa000ZVFwTlF6bDBXbGhLYmxwVVFUUkNaMjl5UW1kRlJVRlpUeTlOUVVWVVFrTnZUVXRIV210T1JGbDVUa2RTYUUxVVJYaE5SRkpvV1hwUk5FMXFRWHBhUjAwd0NrMVVhR2xOVjFGNVdXMVJkMDFFV1RKT2FsWnJXa2RaZDBoQldVdExkMWxDUWtGSFJIWjZRVUpHUVZGUFJFRjRkMlJYZUhOWU0wcHNZMWhXYkdNelVYY0tWbWRaUzB0M1dVSkNRVWRFZG5wQlFrWlJVa2xFUlZwdlpFaFNkMk42YjNaTU1tUndaRWRvTVZscE5XcGlNakIyWTBoV2MyTXlWbXhpYldSd1ltMVZkZ3BrTTA1cVRESkdhbVJIYkhaaWJrMTJZMjVXZFdONU9IaFBWRTAwVG5wck1VOVVUWGhOZVRsb1pFaFNiR0pZUWpCamVUaDRUVUpaUjBOcGMwZEJVVkZDQ21jM09IZEJVbGxGUTBGM1IyTklWbWxpUjJ4cVRVbEhURUpuYjNKQ1owVkZRV1JhTlVGblVVTkNTREJGWlhkQ05VRklZMEV6VkRCM1lYTmlTRVZVU21vS1IxSTBZMjFYWXpOQmNVcExXSEpxWlZCTE15OW9OSEI1WjBNNGNEZHZORUZCUVVkaGFIVlVSWGhuUVVGQ1FVMUJVMFJDUjBGcFJVRnpabUZJUmtWQmVncFFhR1pPTlM4MVVURnVWSGRFYjB4S1MwSnhhRGhMWjBadlNIQjNTa1pGZGtWNVVVTkpVVU5qY2tsaWRrbENUM1ZRWjNRemRVSlBRVFZ2VjJVMVdETkRDbmxYVms1WU9USktPV001TTAxU1FuQlBla0ZMUW1kbmNXaHJhazlRVVZGRVFYZE9iMEZFUW14QmFrVkJaMVJZUVU1TWFGRTNibUZRYTB0dFdTdEVVMUVLZVRoRFdUTklVbXh5TDFaMGExSlhVVTEzUTNaTWJ6SlljemxLVjBsbWRrSnZUR1pZVml0eGMxUnBRV05CYWtKdFJITnlVMFF3V1ZsUFoyeG1URTB5TndwbmJuZFJkVlpWWkRkM01WWlhlRWRxTUd0NFdpOWxNVFpIWVc5SmJtMW9PRFZtVWxGNFZGWnJaSGRyT1dWc1p6MEtMUzB0TFMxRlRrUWdRMFZTVkVsR1NVTkJWRVV0TFMwdExRb3RMUzB0TFVKRlIwbE9JRU5GVWxSSlJrbERRVlJGTFMwdExTMEtUVWxKUTBkcVEwTkJZVWRuUVhkSlFrRm5TVlZCVEc1V2FWWm1ibFV3WW5KS1lYTnRVbXRJY200dlZXNW1ZVkYzUTJkWlNVdHZXa2w2YWpCRlFYZE5kd3BMYWtWV1RVSk5SMEV4VlVWRGFFMU5ZekpzYm1NelVuWmpiVlYxV2tkV01rMVNSWGRFZDFsRVZsRlJSRVYzYUhwaFYyUjZaRWM1ZVZwVVFXVkdkekI1Q2sxcVFUQk5WRTE1VFVSQk1rMVVWbUZHZHpCNlRWUkZkMDFFVlhoTmVsVXlUbFJvWVUxRVkzaEdWRUZVUW1kT1ZrSkJiMVJFU0U1d1dqTk9NR0l6U213S1RHMVNiR1JxUldWTlFuZEhRVEZWUlVGNFRWWmpNbXh1WXpOU2RtTnRWWFJoVnpVd1dsaEtkRnBYVW5CWldGSnNUVWhaZDBWQldVaExiMXBKZW1vd1F3cEJVVmxHU3pSRlJVRkRTVVJaWjBGRk9ISldVeTk1YzBnclRrOTJkVVJhZVZCSlduUnBiR2RWUmpsT2JHRnlXWEJCWkRsSVVERjJRa0pJTVZVMVExWTNDamRNVTFNM2N6QmFhVWcwYmtVM1NIWTNjSFJUTmt4MmRsSXZVMVJyTnprNFRGWm5UWHBNYkVvMFNHVkpaa1l6ZEVoVFlXVjRUR05aY0ZOQlUzSXhhMU1LTUU0dlVtZENTbm92T1dwWFEybFlibTh6YzNkbFZFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwRlJXWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWdwQ1VWVklRWGROZDBWbldVUldVakJVUVZGSUwwSkJaM2RDWjBWQ0wzZEpRa0ZFUVdSQ1owNVdTRkUwUlVablVWVXpPVkJ3ZWpGWmEwVmFZalZ4VG1wd0NrdEdWMmw0YVRSWldrUTRkMGgzV1VSV1VqQnFRa0puZDBadlFWVlhUVUZsV0RWR1JuQlhZWEJsYzNsUmIxcE5hVEJEY2taNFptOTNRMmRaU1V0dldra0tlbW93UlVGM1RVUmFkMEYzV2tGSmQxQkRjMUZMTkVSWmFWcFpSRkJKWVVScE5VaEdTMjVtZUZoNE5rRlRVMVp0UlZKbWMzbHVXVUpwV0RKWU5sTktVZ3B1V2xVNE5DODVSRnBrYmtaMmRuaHRRV3BDVDNRMlVYQkNiR00wU2k4d1JIaDJhMVJEY1hCamJIWjZhVXcyUWtORFVHNXFaR3hKUWpOUWRUTkNlSE5RQ20xNVoxVlpOMGxwTW5waVpFTmtiR2xwYjNjOUNpMHRMUzB0UlU1RUlFTkZVbFJKUmtsRFFWUkZMUzB0TFMwS0xTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVUk1ZWtORFFWaDVaMEYzU1VKQlowbFZRVXhhVGtGUVJtUjRTRkIzYW1WRWJHOUVkM2xaUTJoQlR5ODBkME5uV1VsTGIxcEplbW93UlVGM1RYY0tTMnBGVmsxQ1RVZEJNVlZGUTJoTlRXTXliRzVqTTFKMlkyMVZkVnBIVmpKTlVrVjNSSGRaUkZaUlVVUkZkMmg2WVZka2VtUkhPWGxhVkVGbFJuY3dlUXBOVkVWM1RVUmplRTE2VlRKT1ZHeGhSbmN3ZWsxVVJYZE5SRlY0VFhwVk1rNVVhR0ZOUTI5NFJsUkJWRUpuVGxaQ1FXOVVSRWhPY0ZvelRqQmlNMHBzQ2t4dFVteGtha1ZTVFVFNFIwRXhWVVZCZUUxSll6SnNibU16VW5aamJWVjNaR3BCVVVKblkzRm9hMnBQVUZGSlFrSm5WWEpuVVZGQlNXZE9hVUZCVkRjS1dHVkdWRFJ5WWpOUVVVZDNVelJKWVdwMFRHc3pMMDlzYm5CbllXNW5ZVUpqYkZsd2MxbENjalZwS3pSNWJrSXdOMk5sWWpOTVVEQlBTVTlhWkhobGVBcFlOamxqTldsV2RYbEtVbEVyU0hvd05YbHBLMVZHTTNWQ1YwRnNTSEJwVXpWemFEQXJTREpIU0VVM1UxaHlhekZGUXpWdE1WUnlNVGxNT1dkbk9USnFDbGw2UW1oTlFUUkhRVEZWWkVSM1JVSXZkMUZGUVhkSlFrSnFRVkJDWjA1V1NGSk5Ra0ZtT0VWQ1ZFRkVRVkZJTDAxQ01FZEJNVlZrUkdkUlYwSkNVbGtLZDBJMVptdFZWMnhhY1d3MmVrcERhR3Q1VEZGTGMxaEdLMnBCWmtKblRsWklVMDFGUjBSQlYyZENVbGwzUWpWbWExVlhiRnB4YkRaNlNrTm9hM2xNVVFwTGMxaEdLMnBCUzBKblozRm9hMnBQVUZGUlJFRjNUbkJCUkVKdFFXcEZRV294YmtobFdGcHdLekV6VGxkQ1RtRXJSVVJ6UkZBNFJ6RlhWMmN4ZEVOTkNsZFFMMWRJVUhGd1lWWnZNR3BvYzNkbFRrWmFaMU56TUdWRk4zZFpTVFJ4UVdwRlFUSlhRamx2ZERrNGMwbHJiMFl6ZGxwWlpHUXpMMVowVjBJMVlqa0tWRTVOWldFM1NYZ3ZjM1JLTlZSbVkweE1aVUZDVEVVMFFrNUtUM05STkhadVFraEtDaTB0TFMwdFJVNUVJRU5GVWxSSlJrbERRVlJGTFMwdExTMEsifX19fQ==".to_string(),
        log_id: "c0d23d6ad406973f9559f3ba2d1ca01f84147d8ffc5b8445c224f98b9591801d".to_string(),
        inclusion_proof: serde_json::to_vec(&serde_json::json!({
            "checkpoint": "rekor.sigstore.dev - 1193050959916656506\n580105391\nxxKAn3hOPRUnzUt2zyR5IqdjR4K2/M3ZnjFozykgtkE=\n\n— rekor.sigstore.dev wNI9ajBEAiA8N8iFmcaGu+fU22RDcfRaUv9Vp7yF+/NSOTH2RLXguAIgLlHTOwnpAkAnvn9fEFipT5aBiS9lof4D0ulP05fOL6Q=\n",
            "hashes": ["57f52d1312f77f083e70205e4e5c0ce548209c5dd16fc2e86538780e51c25878","dd6903679aa3a907e52f34ab1fcfb98fcd7493d3d9c54aa4df53fcd507fcb689","78f266c95b2f7176369fd9c4d7bca6cd9f9fabbb580e79f496f474c2524f1acb","25bd63bd85a402425b419a1d091ff6015420cc661d9751bf312474bae7d2dce2","1dda0f6d09c0012efca4af393e40474553029ae3b0418423ae24909cf521b8b9","eb1c807b68e72e7781659f38330d7eab95ee5192381034eb301c233bdce7335e","b452e188e7a5df0a1600b65933f262d4787fb46dfe71b5148cc6d6950adb8410","33202d97d051f2cf40b36af7e7348441ef1044a38980ee3ab8783443f82acbd9","77d401e26642ada07dc2e8a086f0794ee6db8c2e5b1b441efff857d67217aec0","5d7679e3e7c0f4dc9908659cf20797b275d7734b77f3b943c18bffd09b6970b6","3955192e884350df585a462c12e7602d5eaad1cf210a182a4492f6f1ec72c5e1","74c3d949b24785e81e77517e88c8c366e24a6fcd326261149e80d3c1c984f194","ac7712decadbdafb5c248cedbff9eb9ea15259d38fbe57cc655694912be13cf0","97a7aa7f00bf97be2abed71140fb42d4d17fe4dec0802f2d7fa5b6b6f6e2f6ae","50b40f38cf2e668f063a8e2d2705f79b115522a095894227896a7cbc8b6e6a14","31fd20d296481a708ce45dbdf44d3e9a2afd21e9910f477e05f3f621f41a93b8","3d2f488e4ef368eff88e5cf799996f1f1dede51c49c70c505ca8815079d61136","9e5450df8f5ab739cf4ef476d668f609222b9792f7cc6bcf06e8f2e237c72e5f","6f34c9b02eca3e40b97550f6b97442e60a62613d43498a31bd28463d7c232c12","7f68f59633118f03bca377fd9d2a754bcc6edba20b7a101f51fdf096dad908a5","4f80ea583e36840b4dfaf5fc8ca096aa80b899e13825e908f4bc5818270fcb53"],
            "logIndex": 580097209,
            "rootHash": "c712809f784e3d1527cd4b76cf247922a7634782b6fccdd99e3168cf2920b641",
            "treeSize": 580105391
        })).unwrap(),
        signed_entry_timestamp: "MEUCIC+y+Re027QNWO4Q1KdxATfbqX345ucIVol5jaiE1VraAiEA63PhkF/lh4mbbsbcb2wEJHf/hwMKd2IWZqiEgWz6zWg=".to_string(),
        integrated_time: "2025-11-15T09:42:11Z".to_string(),
    };

    println!("Testing Rekor entry verification...");
    println!("UUID: {}", entry.uuid);
    println!("Log index: {}", entry.log_index);

    use wsc::keyless::RekorClient;
    let client = RekorClient::new();

    match client.verify_inclusion(&entry) {
        Ok(true) => {
            println!("\n✅ SUCCESS! Entry verified correctly!");
        }
        Ok(false) => {
            println!("\n❌ Verification returned false (unexpected)");
        }
        Err(e) => {
            println!("\n❌ Verification FAILED: {}", e);
            std::process::exit(1);
        }
    }
}
